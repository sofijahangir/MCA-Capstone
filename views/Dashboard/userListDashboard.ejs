<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-Language" content="en">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    <%= user.name %>'s Dashboard
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no" />
  <meta name="description" content="This is an example dashboard created using build-in elements and components.">
  <meta name="msapplication-tap-highlight" content="no">
  <link href="https://demo.dashboardpack.com/architectui-html-free/main.css" rel="stylesheet">
</head>
<body>
  <div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header">
    <div class="app-header header-shadow">
      <div class="app-header__logo">
        <div class=""><strong> <em>Dashboard</em> </strong></div>
        <div class="header__pane ml-auto">
          <div>
            <button type="button" class="hamburger close-sidebar-btn hamburger--elastic" data-class="closed-sidebar">
              <span class="hamburger-box">
                <span class="hamburger-inner"></span>
              </span>
            </button>
          </div>
        </div>
      </div>
      <div class="app-header__mobile-menu">
        <div>
          <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
            <span class="hamburger-box">
              <span class="hamburger-inner"></span>
            </span>
          </button>
        </div>
      </div>
      <div class="app-header__menu">
        <span>
          <button type="button" class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
            <span class="btn-icon-wrapper">
              <i class="fa fa-ellipsis-v fa-w-6"></i>
            </span>
          </button>
        </span>
      </div>

    </div>

    <div class="app-main">
      <div class="app-sidebar sidebar-shadow">

        <div class="app-header__mobile-menu">
          <div>
            <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
              <span class="hamburger-box">
                <span class="hamburger-inner"></span>
              </span>
            </button>
          </div>
        </div>
        <div class="app-header__menu">
          <span>
            <button type="button" class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
              <span class="btn-icon-wrapper">
                <i class="fa fa-ellipsis-v fa-w-6"></i>
              </span>
            </button>
          </span>
        </div>
        <div class="scrollbar-sidebar">
          <div class="app-sidebar__inner">
            <ul class="vertical-nav-menu">
              <br>
              <li>
                <a href="/dashboard" class="mm-active">
                  <i class="metismenu-icon pe-7s-user"></i>
                  Welcome <%= user.name %>
                </a>
              </li>
              <li class="app-sidebar__heading">Links</li>
              <li>
                <a href="/" class="mm-active">
                  <i class="metismenu-icon pe-7s-home"></i>
                  Home
                </a>
              </li>

              <li>
                <a href="/post/new" class="mm-active">
                  <i class="metismenu-icon pe-7s-note"></i>
                  New Post
                </a>
              </li>
              <li>
                <a href="/event/new" class="mm-active">
                  <i class="metismenu-icon pe-7s-pen"></i>
                  New Event
                </a>
              </li>
              <li>
                <a href="/logout" class="mm-active">
                  <i class="metismenu-icon pe-7s-power"></i>
                  Logout
                </a>
              </li>


            </ul>
          </div>
        </div>
      </div>
      <div class="app-main__outer">
        <div class="app-main__inner">

          <div class="row">
            <div class="col-md-6 col-xl-4">
              <div class="card mb-3 widget-content bg-midnight-bloom">
                <div class="widget-content-wrapper text-white">
                  <div class="widget-content-left">
                    <div class="widget-heading">Total Students</div>
                  </div>
                  <div class="widget-content-right">
                    <div class="widget-numbers text-white"><span>
                        <%= totalStudents.length %>

                      </span></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6 col-xl-4">
              <div class="card mb-3 widget-content bg-arielle-smile">
                <div class="widget-content-wrapper text-white">
                  <div class="widget-content-left">
                    <div class="widget-heading">Total Admins</div>
                  </div>
                  <div class="widget-content-right">

                    <div class="widget-numbers text-white"><span>
                        <!-- Get the total no of admins -->

                        <%= totalAdmins.length %>
                      </span></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6 col-xl-4">
              <div class="card mb-3 widget-content bg-grow-early">
                <div class="widget-content-wrapper text-white">
                  <div class="widget-content-left">
                    <div class="widget-heading">Total Faculty</div>
                  </div>
                  <div class="widget-content-right">
                    <div class="widget-numbers text-white"><span>
                        <%= totalFaculty.length %>
                      </span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>






          <!-- All Posts  End -->
          <div class="row">
            <div class="col-md-12">
              <div class="main-card mb-3 card">
                <div class="card-header">All Users
                </div>

                <div class="table-responsive">
                  <table class="align-middle mb-0 table table-borderless table-striped table-hover">
                    <thead>
                      <tr>
                        <th class="text-center">#</th>
                        <th>Name</th>
                        <th class="text-center">Manage Roles</th>
                        <th class="text-center">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- All the posts of user -->
                      <% var serial=0; %>

                        <% users.forEach(user=> { %>
                          <!-- Event Id -->
                          <%var id=user._id %>
                            <!-- Event Id -->
                            <tr>
                              <td class="text-center text-muted">
                                #<%= serial+=1 %>

                              </td>
                              <td>
                                <div class="widget-content p-0">
                                  <div class="widget-content-wrapper">
                                    <div class="widget-content-left mr-3">
                                      <div class="widget-content-left">
                                        <img width="40" class="rounded-circle" src="assets/images/avatars/4.jpg" alt="">
                                      </div>
                                    </div>
                                    <div class="widget-content-left flex2">
                                      <div class="widget-heading">
                                        <%= user.name %>
                                      </div>

                                    </div>
                                  </div>
                                </div>
                              </td>

                              <td class="text-center">

                                <!-- If user is faculty -->
                                <% if(user.isSuperAdmin ){ %>
                                  <div class="badge badge-danger">Super Admin</div>
                                  <!-- If user is admin -->
                                  <% }else if(user.isAdmin ){ %>
                                    <div class="badge badge-warning">Admin</div>
                                    <!-- If user is student -->
                                    <% }else if(user.isFaculty ){ %>
                                      <div class="badge badge-info">Faculty</div>
                                      <!-- If user is student -->
                                      <% } else if((!user.isAdmin) || (!user.isFaculty) ){ %>
                                        <div class="badge badge-dark">Student</div>
                                        <% } %>


                                          <div class="badge badge-success">

                                            <button
                                              onclick="window.location.href = 'http://localhost:3000/user/setRole/?id=<%= user._id %>&role=admin';"
                                              class="btn-wide btn btn-success">Set as
                                              Admin</button>

                                          </div>
                                          <div class="badge badge-success">
                                            <button
                                              onclick="window.location.href = 'http://localhost:3000/user/setRole/?id=<%= user._id %>&role=faculty';"
                                              class="btn-wide btn btn-success">Set as
                                              Faculty</button>
                                          </div>
                                          <div class="badge badge-success">
                                            <button
                                              onclick="window.location.href = 'http://localhost:3000/user/setRole/?id=<%= user._id %>&role=null';"
                                              class="btn-wide btn btn-success">Remove Both Roles
                                            </button>
                                          </div>

                              </td>
                              <td class="text-center">

                                <button class="mr-2 btn-icon btn-icon-only btn btn-outline-primary"><i class="pe-7s-note btn-icon-wrapper">
                                  </i></button>

                                <button class="mr-2 btn-icon btn-icon-only btn btn-outline-danger"
                                  onclick="window.location.href = 'http://localhost:3000/user/delete/<%= id; %>';"><i
                                    class="pe-7s-trash btn-icon-wrapper" alt="Delete User">
                                  </i>
                                </button>
                                <!-- <button class="mr-2 btn-icon btn-icon-only btn btn-outline-danger" onclick=deletePost();><i
                                    class="pe-7s-trash btn-icon-wrapper">
                                  </i>
                                </button> -->
                              </td>
                            </tr>

                            <script>
                              function deletePost() {

                                var choice = confirm("Are you sure you want to delete this post?");
                                if (choice == true) {
                                  window.location.href = "http://localhost:3000/post/delete/<%= id; %>";
                                } else {
                                  return;
                                }
                              } 
                            </script>

                            <% }) %>

                              <!-- Posts End -->





                    </tbody>
                  </table>
                </div>
                <!-- <div class="d-block text-center card-footer">
                                              <button class="mr-2 btn-icon btn-icon-only btn btn-outline-danger"><i
                                                      class="pe-7s-trash btn-icon-wrapper"> </i></button>
                                              <button class="btn-wide btn btn-success">Save</button>
                                          </div> -->
              </div>
            </div>
          </div>
          <!-- All Posts  End-->

          <!-- All Posts -->
          <!-- All Posts  End-->



        </div>
      </div>
      <script src="http://maps.google.com/maps/api/js?sensor=true"></script>
    </div>
  </div>

  <script type="text/javascript" src="https://demo.dashboardpack.com/architectui-html-free/assets/scripts/main.js"></script>
</body>
</html>
